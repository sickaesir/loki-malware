#include "vs_detector.h"
#include <windows.h>
#include <stdio.h>

bool is_vs_installed()
{
#ifdef _DEBUG
	printf("is_vs_installed() called!\r\n");
#endif // _DEBUG

	HKEY hk = nullptr;
	for (int i = 0; i < 30; i++)
	{
		char buf[64];
		sprintf(buf, "VisualStudio.DTE.%d.0", i);
		if (ERROR_SUCCESS == RegOpenKeyEx(HKEY_CLASSES_ROOT, buf, 0, KEY_QUERY_VALUE, &(hk = nullptr)))
			return true;
	}

	return false;
}